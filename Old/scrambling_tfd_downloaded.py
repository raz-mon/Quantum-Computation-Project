# -*- coding: utf-8 -*-
"""Scrambling_TFD.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1XNCIs7nVMoxJCLeEDKYLnOaKRxBL1iZa
"""

#!pip install qiskit[visualization]

import numpy as np
from qiskit import QuantumCircuit, ClassicalRegister, QuantumRegister
from qiskit import BasicAer, Aer
from qiskit.compiler import transpile
from qiskit.quantum_info.operators import Operator
from qiskit.quantum_info import process_fidelity

"""
# This is the scrambling operator from pg.6 (methods\implementing and optimizing scrambling operators).
mat = 0.5*np.array([[-1, 0, 0, -1, 0, -1, -1, 0], [0, 1, -1, 0, -1, 0, 0, 1], [0, -1, 1, 0, -1, 0, 0, 1], [1, 0, 0, 1, 0, -1, -1, 0],
               [0, -1, -1, 0, 1, 0, 0, 1], [1, 0, 0, -1, 0, 1, -1, 0], [1, 0, 0, -1, 0, -1, 1, 0], [0, -1, -1, 0, -1, 0, 0, -1]])
op1 = Operator(mat)     # The operator form of the scrambling matrix (to qiskit).
"""

# This is the scrambling circuit, we currently use the next cell's scrambling operator (the same, with a little chopping up front).
"""
from qiskit import QuantumRegister, ClassicalRegister, QuantumCircuit
from numpy import pi

# We Make qreg_q_2 and circuit2 just to make an operator out of the scrabmling circtuit (takes 3 qubits as arguments).
qreg_q_2 = QuantumRegister(3, 'scramb')
circuit2 = QuantumCircuit(qreg_q_2)
circuit2.rxx(pi/2, qreg_q_2[0], qreg_q_2[1])
circuit2.rxx(pi/2, qreg_q_2[0], qreg_q_2[2])
circuit2.rxx(pi/2, qreg_q_2[1], qreg_q_2[2])
circuit2.rz(pi/2, qreg_q_2[0])
circuit2.rz(pi/2, qreg_q_2[1])
circuit2.rz(pi/2, qreg_q_2[2])
circuit2.rxx(pi/2, qreg_q_2[0], qreg_q_2[1])
circuit2.rxx(pi/2, qreg_q_2[0], qreg_q_2[2])
circuit2.rxx(pi/2, qreg_q_2[1], qreg_q_2[2])
circuit2.rz(-pi/2, qreg_q_2[0])
circuit2.rz(-pi/2, qreg_q_2[1])
circuit2.rz(-pi/2, qreg_q_2[2])

op = Operator(circuit2)              # The scrambling operator of the system.
#print(op)
scramble_gate = circuit2.to_gate(label='Scrambler')
"""

# This is an attempt to make a gate from an operator exactly as depicted in the main artice.
# We try to do this with an operator made from a matrix rather then a circuit (above).
from qiskit.extensions import UnitaryGate

#This is the exact matrix from eq.4 in Methods from the main article (scrambling), multiplied by i (j in python).
mat1 = 0.5j*np.array([[-1, 0, 0, -1, 0, -1, -1, 0], [0, 1, -1, 0, -1, 0, 0, 1], [0, -1, 1, 0, -1, 0, 0, 1], 
                    [1, 0, 0, 1, 0, -1, -1, 0], [0, -1, -1, 0, 1, 0, 0, 1], [1, 0, 0, -1, 0, 1, -1, 0],
                    [1, 0, 0, -1, 0, -1, 1, 0], [0, -1, -1, 0, -1, 0, 0, -1]])

mat2 = -0.5j*np.array([[-1, 0, 0, -1, 0, -1, -1, 0], [0, 1, -1, 0, -1, 0, 0, 1], [0, -1, 1, 0, -1, 0, 0, 1], 
                    [1, 0, 0, 1, 0, -1, -1, 0], [0, -1, -1, 0, 1, 0, 0, 1], [1, 0, 0, -1, 0, 1, -1, 0],
                    [1, 0, 0, -1, 0, -1, 1, 0], [0, -1, -1, 0, -1, 0, 0, -1]])

mat3 = 0.5*np.array([[-1, 0, 0, -1, 0, -1, -1, 0], [0, 1, -1, 0, -1, 0, 0, 1], [0, -1, 1, 0, -1, 0, 0, 1], 
                    [1, 0, 0, 1, 0, -1, -1, 0], [0, -1, -1, 0, 1, 0, 0, 1], [1, 0, 0, -1, 0, 1, -1, 0],
                    [1, 0, 0, -1, 0, -1, 1, 0], [0, -1, -1, 0, -1, 0, 0, -1]])

scramble_gate2_1 = UnitaryGate(mat1)
scramble_gate2_1.label = 'scrambler_2_1'
scramble_gate2_1_c = UnitaryGate(mat1.conjugate())
scramble_gate2_1_c.label = 'scrambler_2_1_c'


scramble_gate2_2 = UnitaryGate(mat1)
scramble_gate2_2.label = 'scrambler_2_2'
scramble_gate2_2_c = UnitaryGate(mat2.conjugate())
scramble_gate2_2_c.label = 'scrambler_2_2_c'

scramble_gate2_3 = UnitaryGate(mat3)
scramble_gate2_3.label = 'scrambler_2_3'
scramble_gate2_3_c = UnitaryGate(mat3.conjugate())
scramble_gate2_3_c.label = 'scrambler_2_3_c'

# circuit will be our main circuit.
qreg_q = QuantumRegister(7, 'q')
creg_c = ClassicalRegister(7, 'c')
circuit = QuantumCircuit(qreg_q, creg_c)

# Make a circuit that makes a bell pair out of the two given qubits, give it a name.
def create_bell_pair(qc, a, b):
    """Creates a bell pair in qc using qubits a & b"""
    qc.h(a) # Put qubit a into state |+>
    qc.cx(a,b) # CNOT with a as control and b as target

qreg = QuantumRegister(2, 'q')
circ = QuantumCircuit(qreg)
create_bell_pair(circ, qreg[0], qreg[1])

bell_gate = circ.to_gate(label = 'bell')

inv_Bell_circ = circ.inverse()
inv_Bell_gate = inv_Bell_circ.to_gate(label='inv_bell')

# Generating a random state_vector:
from qiskit.quantum_info import random_statevector
from qiskit.extensions import Initialize
psi = random_statevector(dims=2)
# Make a gate from this operator:
init_gate = Initialize(psi)
init_gate.label = 'init_gate'

# Save the inverse of the gate (in order to return later to the state psi - with the 'target' qubit of the teleportation)
inverse_init_gate = init_gate.gates_to_uncompute()
inverse_init_gate.label = 'inverse_init_gate'
# If the teleportation has indeed worked properly, then after applying this gate to the 'target' of the teleportation qubit, it should be in state |0>.

# Here we initialize qubits 1-6 states as the tfd, which we constructed in Mathematica:

# Remember, qubit 3 is 5 and 5 is 3. With this transformation, we should get the right couples as in the article.


# A dictionary, with beta as the key, and the tfd state as the value:
tfds = {0: [0.3535533905932739, 0, 0, 0, 0, 0, 0, 0, 0, 0.3535533905932738, 0, 0, 0, 0, 0, 0, 0, 0, 0.35355339059327373, 0, 0, 0, 0, 0, 0, 0, 0, 0.3535533905932737, 0, 0, 0, 0, 0, 0, 0, 0, 0.3535533905932738, 0, 0, 0, 0, 0, 0, 0, 0, 0.35355339059327373, 0, 0, 0, 0, 0, 0, 0, 0, 0.35355339059327373, 0, 0, 0, 0, 0, 0, 0, 0, 0.3535533905932736], 
        0.05: [0.3942596592892492,-0.0097266190063537,-0.00972661900635369,0.000247903513419207,-0.00972661900635353,0.0002479035134190986,0.000247903513419257,-6.531762232662407*(10**(-6)),-0.0097266190063537,0.347950618465318,0.0002438072435902303,-0.00901843048068528,0.0002438072435901414,-0.00901843048068529,-6.317308316681239*10**(-6),0.0002416827874833454,-0.00972661900635369,0.0002438072435902303,0.347950618465318,-0.00901843048068522,0.0002438072435901859,-6.317308316714593*10**(-6),-0.00901843048068533,0.0002416827874833566,0.000247903513419207,-0.00901843048068528,-0.00901843048068522,0.3393615349342291,-6.317308316720151*10**(-6),0.0002376886385666789,0.0002376886385667706,-0.0092484973370448,-0.00972661900635353,0.0002438072435901414,0.0002438072435901859,-6.317308316720151*10**(-6),0.347950618465318,-0.00901843048068529,-0.00901843048068518,0.0002416827874833566,0.0002479035134190986,-0.00901843048068529,-6.317308316714593*10**(-6),0.0002376886385666789,-0.00901843048068529,0.3393615349342292,0.0002376886385667123,-0.0092484973370448,0.000247903513419257,-6.317308316681239*10**(-6),-0.00901843048068533,0.0002376886385667706,-0.00901843048068518,0.0002376886385667123,0.3393615349342291,-0.00924849733704479,-6.531762232662407*(10**(-6)),0.0002416827874833454,0.0002416827874833566,-0.0092484973370448,0.0002416827874833566,-0.0092484973370448,-0.00924849733704479,0.3657778247422378],
        0.1: [0.4363275423829362,-0.02025341141913618,-0.02025341141913617,0.001001810202794411,-0.020253411419136,0.001001810202794292,0.001001810202794479,-0.00005294181257830665,-0.02025341141913618,0.3399483351247184,0.000969005691102744,-0.01739280818246144,0.000969005691102695,-0.01739280818246145,-0.00004951855567368293,0.000951389428910322,-0.02025341141913617,0.000969005691102744,0.3399483351247183,-0.01739280818246137,0.000969005691102719,-0.00004951855567372037,-0.01739280818246148,0.000951389428910322,0.001001810202794411,-0.01739280818246144,-0.01739280818246137,0.3233821257809909,-0.0000495185556737266,0.000920215039554124,0.000920215039554249,-0.01829718172439996,-0.020253411419136,0.000969005691102695,0.000969005691102719,-0.0000495185556737266,0.3399483351247184,-0.01739280818246147,-0.01739280818246135,0.000951389428910335,0.001001810202794292,-0.01739280818246145,-0.00004951855567372037,0.000920215039554124,-0.01739280818246147,0.323382125780991,0.000920215039554164,-0.01829718172439996,0.001001810202794479,-0.00004951855567368293,-0.01739280818246148,0.000920215039554249,-0.01739280818246135,0.000920215039554164,0.323382125780991,-0.01829718172439994,-0.00005294181257830665,0.000951389428910322,0.000951389428910322,-0.01829718172439996,0.000951389428910335,-0.01829718172439996,-0.01829718172439994,0.3755974390719925], 
        0.15: [0.4789058041586374,-0.03140345005510608,-0.03140345005510606,0.002259845563497157,-0.03140345005510588,0.002259845563497043,0.00225984556349724,-0.0001794885969559068,-0.03140345005510608,0.3295854125668542,0.002149922180564648,-0.0249553175137374,0.002149922180564586,-0.02495531751373741,-0.0001623504597090586,0.002088904042586783,-0.03140345005510606,0.002149922180564648,0.3295854125668541,-0.02495531751373738,0.002149922180564606,-0.0001623504597090724,-0.02495531751373747,0.002088904042586783,0.002259845563497157,-0.0249553175137374,-0.02495531751373738,0.3058102824884151,-0.0001623504597091002,0.001987141677390815,0.001987141677390916,-0.02693618086662529,-0.03140345005510588,0.002149922180564586,0.002149922180564606,-0.0001623504597091002,0.3295854125668542,-0.02495531751373747,-0.02495531751373733,0.002088904042586797,0.002259845563497043,-0.02495531751373741,-0.0001623504597090724,0.001987141677390815,-0.02495531751373747,0.3058102824884151,0.001987141677390818,-0.02693618086662528,0.00225984556349724,-0.0001623504597090586,-0.02495531751373747,0.001987141677390916,-0.02495531751373733,0.001987141677390818,0.3058102824884151,-0.02693618086662527,-0.0001794885969559068,0.002088904042586783,0.002088904042586783,-0.02693618086662529,0.002088904042586797,-0.02693618086662528,-0.02693618086662527,0.3825672745198095], 
        0.2: [0.5210665697519231,-0.04295581975506426,-0.04295581975506424,0.003995868141227026,-0.04295581975506408,0.003995868141226911,0.003995868141227117,-0.0004236245742735106,-0.04295581975506426,0.3170280598360308,0.003739361777591377,-0.03156559387297525,0.003739361777591308,-0.03156559387297527,-0.000370544102868009,0.003592416165728468,-0.04295581975506424,0.003739361777591377,0.3170280598360307,-0.03156559387297522,0.003739361777591331,-0.0003705441028680394,-0.03156559387297531,0.003592416165728468,0.003995868141227026,-0.03156559387297525,-0.03156559387297522,0.2869403130658612,-0.0003705441028680585,0.003361186217047734,0.003361186217047838,-0.03496040236653783,-0.04295581975506408,0.003739361777591308,0.003739361777591331,-0.0003705441028680585,0.3170280598360308,-0.03156559387297531,-0.03156559387297519,0.003592416165728483,0.003995868141226911,-0.03156559387297527,-0.0003705441028680394,0.003361186217047734,-0.03156559387297531,0.2869403130658612,0.003361186217047771,-0.03496040236653781,0.003995868141227117,-0.000370544102868009,-0.03156559387297531,0.003361186217047838,-0.03156559387297519,0.003361186217047771,0.2869403130658611,-0.03496040236653779,-0.0004236245742735106,0.003592416165728468,0.003592416165728468,-0.03496040236653783,0.003592416165728483,-0.03496040236653781,-0.03496040236653779,0.3863647170728933], 
        0.25: [0.561889533914085, -0.05466298934252371, -0.05466298934252369, 0.006160351920186862, -0.054662989342523526, 0.006160351920186742, 0.006160351920186966, -0.0008165476423440626, -0.05466298934252371, 0.3025675883535264, 0.0056713500754095175, -0.03712490582301628, 0.005671350075409459, -0.037124905823016294, -0.0006907037088619333, 0.00538268749890683, -0.05466298934252369, 0.0056713500754095175, 0.30256758835352626, -0.03712490582301626, 0.005671350075409492, -0.0006907037088619458, -0.037124905823016335, 0.00538268749890683, 0.006160351920186862, -0.03712490582301628, -0.03712490582301626, 0.2671506095061383, -0.0006907037088619458, 0.00495361133673995, 0.004953611336740056, -0.04218835290285327, -0.054662989342523526, 0.005671350075409459, 0.005671350075409492, -0.0006907037088619458, 0.3025675883535263, -0.037124905823016335, -0.037124905823016224, 0.00538268749890683, 0.006160351920186742, -0.037124905823016294, -0.0006907037088619458, 0.00495361133673995, -0.037124905823016335, 0.26715060950613834, 0.004953611336739962, -0.04218835290285324, 0.006160351920186966, -0.0006907037088619333, -0.037124905823016335, 0.004953611336740056, -0.037124905823016224, 0.004953611336739962, 0.2671506095061383, -0.04218835290285326, -0.0008165476423440626, 0.00538268749890683, 0.00538268749890683, -0.04218835290285327, 0.00538268749890683, -0.04218835290285324, -0.04218835290285326, 0.3868306083328138], 
        0.3: [0.6005495418150076,-0.06627309834713346,-0.06627309834713342,0.0086844716353453,-0.06627309834713326,0.00868447163534519,0.00868447163534543,-0.001380460287640173,-0.06627309834713346,0.2865992161885071,0.007866543145896556,-0.04158590144711683,0.007866543145896494,-0.04158590144711683,-0.001129301885699542,0.007369747551878482,-0.06627309834713342,0.007866543145896556,0.286599216188507,-0.04158590144711683,0.007866543145896548,-0.001129301885699547,-0.0415859014471169,0.007369747551878492,0.0086844716353453,-0.04158590144711683,-0.04158590144711683,0.246873996523662,-0.001129301885699551,0.00667141830144902,0.006671418301449106,-0.04847912943841186,-0.06627309834713326,0.007866543145896494,0.007866543145896548,-0.001129301885699551,0.286599216188507,-0.04158590144711688,-0.04158590144711678,0.007369747551878492,0.00868447163534519,-0.04158590144711683,-0.001129301885699547,0.00667141830144902,-0.04158590144711688,0.2468739965236621,0.006671418301449037,-0.04847912943841186,0.00868447163534543,-0.001129301885699542,-0.0415859014471169,0.006671418301449106,-0.04158590144711678,0.006671418301449037,0.246873996523662,-0.04847912943841184,-0.001380460287640173,0.007369747551878482,0.007369747551878492,-0.04847912943841186,0.007369747551878492,-0.04847912943841186,-0.04847912943841184,0.3839891364182655], 
        0.35: [0.636389180069926,-0.0775527566202619,-0.07755275662026189,0.0114867219788224,-0.07755275662026174,0.01148672197882228,0.01148672197882253,-0.002127059202927789,-0.0775527566202619,0.2695850235198826,0.01023937972941071,-0.04495558643334446,0.01023937972941066,-0.04495558643334446,-0.001682988269205279,0.00946095130936739,-0.07755275662026189,0.01023937972941071,0.2695850235198825,-0.04495558643334446,0.01023937972941069,-0.00168298826920527,-0.04495558643334451,0.0094609513093674,0.0114867219788224,-0.04495558643334446,-0.04495558643334446,0.2265587169482578,-0.001682988269205274,0.0084250714093473,0.00842507140934737,-0.05374398078492847,-0.07755275662026174,0.01023937972941066,0.01023937972941069,-0.001682988269205274,0.2695850235198825,-0.04495558643334451,-0.04495558643334443,0.00946095130936739,0.01148672197882228,-0.04495558643334446,-0.00168298826920527,0.0084250714093473,-0.04495558643334451,0.226558716948258,0.0084250714093473,-0.05374398078492847,0.01148672197882253,-0.001682988269205279,-0.04495558643334451,0.00842507140934737,-0.04495558643334443,0.0084250714093473,0.226558716948258,-0.05374398078492844,-0.002127059202927789,0.00946095130936739,0.0094609513093674,-0.05374398078492847,0.00946095130936739,-0.05374398078492847,-0.05374398078492844,0.3780411879622991], 
        0.4: [0.6689621823690369,-0.0883057778899238,-0.0883057778899238,0.0144807217129389,-0.0883057778899236,0.01448072171293878,0.01448072171293905,-0.003057464662019415,-0.0883057778899238,0.2520087814791093,0.0127055700390362,-0.04729097332322564,0.01270557003903614,-0.04729097332322566,-0.002340092578620995,0.01156885060625377,-0.0883057778899238,0.0127055700390362,0.2520087814791092,-0.04729097332322563,0.01270557003903616,-0.00234009257862099,-0.04729097332322571,0.01156885060625378,0.0144807217129389,-0.04729097332322564,-0.04729097332322563,0.206628153512514,-0.002340092578621025,0.01013530468635021,0.01013530468635029,-0.05795024023986351,-0.0883057778899236,0.01270557003903614,0.01270557003903616,-0.002340092578621025,0.2520087814791093,-0.04729097332322567,-0.04729097332322562,0.01156885060625378,0.01448072171293878,-0.04729097332322566,-0.00234009257862099,0.01013530468635021,-0.04729097332322567,0.2066281535125141,0.01013530468635025,-0.0579502402398635,0.01448072171293905,-0.002340092578620995,-0.04729097332322571,0.01013530468635029,-0.04729097332322562,0.01013530468635025,0.2066281535125141,-0.05795024023986349,-0.003057464662019415,0.01156885060625377,0.01156885060625378,-0.05795024023986351,0.01156885060625378,-0.0579502402398635,-0.05795024023986349,0.3693331766437456], 
        0.45: [0.6980424159320019,-0.0983846835403727,-0.0983846835403727,0.01758265054425627,-0.0983846835403725,0.01758265054425616,0.01758265054425643,-0.00416343135374778,-0.0983846835403727,0.2343321782718148,0.01518852284965251,-0.04868879203673805,0.01518852284965247,-0.04868879203673806,-0.003082925536694471,0.01361747782640127,-0.0983846835403727,0.01518852284965251,0.2343321782718147,-0.04868879203673804,0.01518852284965249,-0.00308292553669445,-0.0486887920367381,0.01361747782640127,0.01758265054425627,-0.04868879203673805,-0.04868879203673804,0.1874473735620387,-0.003082925536694469,0.0117378767113466,0.01173787671134668,-0.06111756562954609,-0.0983846835403725,0.01518852284965247,0.01518852284965249,-0.003082925536694469,0.2343321782718148,-0.04868879203673808,-0.04868879203673803,0.01361747782640127,0.01758265054425616,-0.04868879203673806,-0.00308292553669445,0.0117378767113466,-0.04868879203673808,0.1874473735620388,0.01173787671134662,-0.06111756562954609,0.01758265054425643,-0.003082925536694471,-0.0486887920367381,0.01173787671134668,-0.04868879203673803,0.01173787671134662,0.1874473735620387,-0.06111756562954608,-0.00416343135374778,0.01361747782640127,0.01361747782640127,-0.06111756562954609,0.01361747782640127,-0.06111756562954609,-0.06111756562954608,0.3583097874163469], 
        0.5: [0.7236027674363145, -0.10769409384157305, -0.10769409384157301, 0.0207170849324121, -0.10769409384157287, 0.020717084932411978, 0.020717084932412266, -0.005429411630878292, -0.10769409384157305, 0.21696038452737632, 0.017623767240278223, -0.04927194924894767, 0.017623767240278185, -0.049271949248947663, -0.0038903583452016646, 0.015546216712528012, -0.10769409384157301, 0.017623767240278223, 0.21696038452737623, -0.04927194924894766, 0.017623767240278202, -0.0038903583452016455, -0.04927194924894773, 0.015546216712528023, 0.0207170849324121, -0.04927194924894767, -0.04927194924894766, 0.16930183605900848, -0.003890358345201637, 0.013185781537382932, 0.013185781537382998, -0.06330834328470764, -0.10769409384157287, 0.017623767240278185, 0.017623767240278202, -0.003890358345201637, 0.21696038452737626, -0.049271949248947705, -0.04927194924894765, 0.015546216712528023, 0.020717084932411978, -0.049271949248947663, -0.0038903583452016455, 0.013185781537382932, -0.049271949248947705, 0.16930183605900856, 0.013185781537382948, -0.06330834328470764, 0.020717084932412266, -0.0038903583452016646, -0.04927194924894773, 0.013185781537382998, -0.04927194924894765, 0.013185781537382948, 0.16930183605900856, -0.06330834328470762, -0.005429411630878292, 0.015546216712528012, 0.015546216712528023, -0.06330834328470764, 0.015546216712528023, -0.06330834328470764, -0.06330834328470762, 0.34546194652216883], 
        0.55: [0.7457744977420235,-0.1161872230694806,-0.1161872230694805,0.02382062668406224,-0.1161872230694804,0.02382062668406213,0.02382062668406242,-0.006834952284096719,-0.1161872230694806,0.2002211059656543,0.01996107716872121,-0.04917565929596745,0.01996107716872119,-0.04917565929596745,-0.004740213065051828,0.01731114831825586,-0.1161872230694805,0.01996107716872121,0.2002211059656542,-0.04917565929596743,0.0199610771687212,-0.004740213065051814,-0.04917565929596751,0.01731114831825586,0.02382062668406224,-0.04917565929596745,-0.04917565929596743,0.1523896498651875,-0.004740213065051828,0.01444909366912659,0.01444909366912666,-0.06461509760859359,-0.1161872230694804,0.01996107716872119,0.0199610771687212,-0.004740213065051828,0.2002211059656542,-0.04917565929596747,-0.04917565929596743,0.01731114831825586,0.02382062668406213,-0.04917565929596745,-0.004740213065051814,0.01444909366912659,-0.04917565929596747,0.1523896498651876,0.01444909366912661,-0.06461509760859359,0.02382062668406242,-0.004740213065051828,-0.04917565929596751,0.01444909366912666,-0.04917565929596743,0.01444909366912661,0.1523896498651875,-0.06461509760859359,-0.006834952284096719,0.01731114831825586,0.01731114831825586,-0.06461509760859359,0.01731114831825586,-0.06461509760859359,-0.06461509760859359,0.3312801051629108], 
        0.6: [0.7647991035352071,-0.1238578856616171,-0.1238578856616171,0.0268433517388569,-0.1238578856616169,0.02684335173885678,0.02684335173885708,-0.00835698219430474,-0.1238578856616171,0.184357206644306,0.02216457241855191,-0.04853550554606304,0.02216457241855188,-0.04853550554606305,-0.005611161060514998,0.01888432107761429,-0.1238578856616171,0.02216457241855191,0.1843572066443059,-0.04853550554606305,0.02216457241855188,-0.005611161060514958,-0.0485355055460631,0.01888432107761429,0.0268433517388569,-0.04853550554606304,-0.04853550554606305,0.136825381774822,-0.005611161060514975,0.01551307563054243,0.01551307563054248,-0.06514766267213433,-0.1238578856616169,0.02216457241855188,0.02216457241855188,-0.005611161060514975,0.1843572066443059,-0.04853550554606308,-0.04853550554606305,0.0188843210776143,0.02684335173885678,-0.04853550554606305,-0.005611161060514958,0.01551307563054243,-0.04853550554606308,0.1368253817748221,0.01551307563054245,-0.06514766267213433,0.02684335173885708,-0.005611161060514998,-0.0485355055460631,0.01551307563054248,-0.04853550554606305,0.01551307563054245,0.1368253817748221,-0.06514766267213433,-0.00835698219430474,0.01888432107761429,0.01888432107761429,-0.06514766267213433,0.0188843210776143,-0.06514766267213433,-0.06514766267213433,0.3162190699439194], 
        .65: [0.7809824259790227,-0.1307305808809177,-0.1307305808809177,0.02974853111778727,-0.1307305808809176,0.02974853111778716,0.02974853111778746,-0.00997171226789228,-0.1307305808809177,0.1695301421760706,0.02421138520755386,-0.04747862607347774,0.02421138520755384,-0.04747862607347775,-0.006484015495415099,0.02025166229122319,-0.1307305808809177,0.02421138520755386,0.1695301421760705,-0.04747862607347773,0.02421138520755385,-0.006484015495415056,-0.0474786260734778,0.02025166229122319,0.02974853111778727,-0.04747862607347774,-0.04747862607347773,0.1226515950715787,-0.006484015495415072,0.0163753243678836,0.01637532436788367,-0.0650220751074519,-0.1307305808809176,0.02421138520755384,0.02421138520755385,-0.006484015495415072,0.1695301421760705,-0.04747862607347776,-0.04747862607347775,0.0202516622912232,0.02974853111778716,-0.04747862607347775,-0.006484015495415056,0.0163753243678836,-0.04747862607347776,0.1226515950715787,0.01637532436788364,-0.0650220751074519,0.02974853111778746,-0.006484015495415099,-0.0474786260734778,0.01637532436788367,-0.04747862607347775,0.01637532436788364,0.1226515950715787,-0.06502207510745189,-0.00997171226789228,0.02025166229122319,0.02025166229122319,-0.0650220751074519,0.0202516622912232,-0.0650220751074519,-0.06502207510745189,0.3006762766747623], 
        0.7: [0.7946568199413823,-0.1368506819140008,-0.1368506819140007,0.03251123577047542,-0.1368506819140006,0.03251123577047531,0.03251123577047561,-0.01165603808370504,-0.1368506819140008,0.1558302969764206,0.02608954031485865,-0.046118230504415,0.02608954031485861,-0.04611823050441499,-0.00734245078587281,0.02141024711932777,-0.1368506819140007,0.02608954031485865,0.1558302969764205,-0.04611823050441499,0.02608954031485863,-0.007342450785872765,-0.04611823050441505,0.02141024711932777,0.03251123577047542,-0.046118230504415,-0.04611823050441499,0.1098540834970574,-0.007342450785872777,0.01704264085315485,0.01704264085315488,-0.06435214839771596,-0.1368506819140006,0.02608954031485861,0.02608954031485863,-0.007342450785872777,0.1558302969764205,-0.04611823050441501,-0.046118230504415,0.02141024711932777,0.03251123577047531,-0.04611823050441499,-0.007342450785872765,0.01704264085315485,-0.04611823050441501,0.1098540834970575,0.01704264085315485,-0.06435214839771598,0.03251123577047561,-0.00734245078587281,-0.04611823050441505,0.01704264085315488,-0.046118230504415,0.01704264085315485,0.1098540834970575,-0.06435214839771596,-0.01165603808370504,0.02141024711932777,0.02141024711932777,-0.06435214839771596,0.02141024711932777,-0.06435214839771598,-0.06435214839771596,0.2849821521010432],
        0.75: [0.8061534878599148, -0.14227596039520518, -0.14227596039520513, 0.035116394521364926, -0.142275960395205, 0.03511639452136483, 0.035116394521365134, -0.01338845984540857, -0.14227596039520518, 0.14329053183048826, 0.02779558588082727, -0.044551003050491804, 0.02779558588082725, -0.044551003050491804, -0.008173262984177053, 0.022365480382880585, -0.14227596039520513, 0.02779558588082727, 0.1432905318304882, -0.044551003050491804, 0.027795585880827263, -0.008173262984177011, -0.04455100305049185, 0.022365480382880585, 0.035116394521364926, -0.044551003050491804, -0.044551003050491804, 0.09837757803895707, -0.00817326298417701, 0.017528098819119764, 0.017528098819119813, -0.06324386212738152, -0.142275960395205, 0.02779558588082725, 0.027795585880827263, -0.00817326298417701, 0.1432905318304882, -0.04455100305049182, -0.04455100305049181, 0.022365480382880585, 0.03511639452136483, -0.044551003050491804, -0.008173262984177011, 0.017528098819119764, -0.04455100305049182, 0.0983775780389571, 0.01752809881911978, -0.06324386212738153, 0.035116394521365134, -0.008173262984177053, -0.04455100305049185, 0.017528098819119813, -0.04455100305049181, 0.01752809881911978, 0.09837757803895708, -0.0632438621273815, -0.01338845984540857, 0.022365480382880585, 0.022365480382880585, -0.06324386212738152, 0.022365480382880585, -0.06324386212738153, -0.0632438621273815, 0.26939956384681135], 
        0.8: [0.815784516752206,-0.1470699588674301,-0.14706995886743,0.03755673083268162,-0.1470699588674299,0.03755673083268152,0.03755673083268185,-0.01514960131369763,-0.1470699588674301,0.1319001681608293,0.02933233639639312,-0.04285665998235157,0.0293323363963931,-0.04285665998235156,-0.00896630861138678,0.02312853910535054,-0.14706995886743,0.02933233639639312,0.1319001681608293,-0.04285665998235155,0.0293323363963931,-0.00896630861138675,-0.04285665998235162,0.02312853910535054,0.03755673083268162,-0.04285665998235157,-0.04285665998235155,0.088139876414632,-0.00896630861138675,0.01784856976540045,0.0178485697654005,-0.06179219373153016,-0.1470699588674299,0.0293323363963931,0.0293323363963931,-0.00896630861138675,0.1319001681608293,-0.04285665998235157,-0.04285665998235157,0.02312853910535054,0.03755673083268152,-0.04285665998235156,-0.00896630861138675,0.01784856976540045,-0.04285665998235157,0.0881398764146321,0.01784856976540048,-0.06179219373153016,0.03755673083268185,-0.00896630861138678,-0.04285665998235162,0.0178485697654005,-0.04285665998235157,0.01784856976540048,0.0881398764146321,-0.06179219373153013,-0.01514960131369763,0.02312853910535054,0.02312853910535054,-0.06179219373153016,0.02312853910535054,-0.06179219373153016,-0.06179219373153013,0.254129062681961], 
        0.85: [0.8238328480472,-0.1512972269123505,-0.1512972269123505,0.03983084272555457,-0.1512972269123503,0.03983084272555448,0.0398308427255548,-0.01692243045321652,-0.1512972269123505,0.1216177031646272,0.03070692251838691,-0.04109891086220548,0.03070692251838688,-0.04109891086220547,-0.00971424697890734,0.0237142422939198,-0.1512972269123505,0.03070692251838691,0.1216177031646272,-0.04109891086220548,0.03070692251838688,-0.00971424697890729,-0.04109891086220553,0.0237142422939198,0.03983084272555457,-0.04109891086220548,-0.04109891086220548,0.0790434149747603,-0.00971424697890729,0.01802279040785165,0.01802279040785168,-0.06007981178592704,-0.1512972269123503,0.03070692251838688,0.03070692251838688,-0.00971424697890729,0.1216177031646271,-0.04109891086220549,-0.04109891086220551,0.0237142422939198,0.03983084272555448,-0.04109891086220547,-0.00971424697890729,0.01802279040785165,-0.04109891086220549,0.07904341497476031,0.01802279040785166,-0.06007981178592704,0.0398308427255548,-0.00971424697890734,-0.04109891086220553,0.01802279040785168,-0.04109891086220551,0.01802279040785166,0.07904341497476032,-0.06007981178592704,-0.01692243045321652,0.0237142422939198,0.0237142422939198,-0.06007981178592704,0.0237142422939198,-0.06007981178592704,-0.06007981178592704,0.2393171163052729], 
        0.9: [0.830548046260359,-0.1550201685229416,-0.1550201685229415,0.04194155659785052,-0.1550201685229414,0.04194155659785043,0.04194155659785074,-0.01869227779303746,-0.1550201685229416,0.1123814449570856,0.03192921790914931,-0.03932719706684418,0.0319292179091493,-0.03932719706684418,-0.01041218300322768,0.02413938727114817,-0.1550201685229415,0.03192921790914931,0.1123814449570855,-0.03932719706684418,0.0319292179091493,-0.01041218300322763,-0.03932719706684424,0.02413938727114817,0.04194155659785052,-0.03932719706684418,-0.03932719706684418,0.07098406927922913,-0.01041218300322764,0.01806995086330869,0.01806995086330873,-0.05817704231112818,-0.1550201685229414,0.0319292179091493,0.0319292179091493,-0.01041218300322764,0.1123814449570855,-0.03932719706684419,-0.03932719706684421,0.02413938727114817,0.04194155659785043,-0.03932719706684418,-0.01041218300322763,0.01806995086330869,-0.03932719706684419,0.07098406927922917,0.0180699508633087,-0.05817704231112818,0.04194155659785074,-0.01041218300322768,-0.03932719706684424,0.01806995086330873,-0.03932719706684421,0.0180699508633087,0.07098406927922919,-0.05817704231112818,-0.01869227779303746,0.02413938727114817,0.02413938727114817,-0.05817704231112818,0.02413938727114817,-0.05817704231112818,-0.05817704231112818,0.225065317352488], 
        0.95: [0.836145913188735,-0.1582971509549926,-0.1582971509549926,0.04389459403440701,-0.1582971509549925,0.04389459403440692,0.04389459403440724,-0.02044672963174059,-0.1582971509549926,0.1041178721108874,0.03301063610906186,-0.03757875120619345,0.03301063610906184,-0.03757875120619345,-0.01105727750415443,0.02442151819465406,-0.1582971509549926,0.03301063610906186,0.1041178721108873,-0.03757875120619346,0.03301063610906185,-0.01105727750415437,-0.0375787512061935,0.02442151819465406,0.04389459403440701,-0.03757875120619345,-0.03757875120619346,0.06385741756804287,-0.01105727750415437,0.01800872794911177,0.0180087279491118,-0.05614261389921392,-0.1582971509549925,0.03301063610906184,0.03301063610906185,-0.01105727750415437,0.1041178721108873,-0.03757875120619345,-0.03757875120619348,0.02442151819465406,0.04389459403440692,-0.03757875120619345,-0.01105727750415437,0.01800872794911177,-0.03757875120619345,0.06385741756804288,0.01800872794911179,-0.05614261389921391,0.04389459403440724,-0.01105727750415443,-0.0375787512061935,0.0180087279491118,-0.03757875120619348,0.01800872794911179,0.06385741756804291,-0.05614261389921391,-0.02044672963174059,0.02442151819465406,0.02442151819465406,-0.05614261389921392,0.02442151819465406,-0.05614261389921391,-0.05614261389921391,0.2114393053604268],
        1: [0.8408104007067837, -0.16118153013370587, -0.1611815301337058, 0.045697537312444664, -0.1611815301337057, 0.045697537312444574, 0.04569753731244489, -0.02217545219517049, -0.16118153013370587, 0.0967478768893801, 0.03396325128375083, -0.035880680587108894, 0.033963251283750814, -0.03588068058710889, -0.01164836664582186, 0.0245780590313299, -0.1611815301337058, 0.03396325128375083, 0.09674787688938005, -0.03588068058710889, 0.033963251283750814, -0.011648366645821803, -0.03588068058710895, 0.0245780590313299, 0.045697537312444664, -0.035880680587108894, -0.03588068058710889, 0.05756290225911019, -0.011648366645821816, 0.017856670883278192, 0.017856670883278223, -0.05402481308036796, -0.1611815301337057, 0.033963251283750814, 0.033963251283750814, -0.011648366645821816, 0.09674787688938005, -0.035880680587108894, -0.03588068058710892, 0.0245780590313299, 0.045697537312444574, -0.03588068058710889, -0.011648366645821803, 0.017856670883278192, -0.035880680587108894, 0.05756290225911022, 0.017856670883278206, -0.054024813080367974, 0.04569753731244489, -0.01164836664582186, -0.03588068058710895, 0.017856670883278223, -0.03588068058710892, 0.017856670883278206, 0.05756290225911023, -0.05402481308036797, -0.02217545219517049, 0.0245780590313299, 0.0245780590313299, -0.05402481308036796, 0.0245780590313299, -0.054024813080367974, -0.05402481308036797, 0.19847673476405833], 
        1.05: [0.84469671274621,-0.1637213005066228,-0.1637213005066228,0.04735905388634821,-0.1637213005066227,0.04735905388634814,0.04735905388634844,-0.02386998456406039,-0.1637213005066228,0.0901912142741904,0.03479918286849337,-0.03425190351355481,0.03479918286849336,-0.0342519035135548,-0.0121856134853478,0.02462573525390973,-0.1637213005066228,0.03479918286849337,0.0901912142741904,-0.03425190351355481,0.03479918286849336,-0.01218561348534774,-0.03425190351355487,0.02462573525390973,0.04735905388634821,-0.03425190351355481,-0.03425190351355481,0.05200636755713202,-0.01218561348534775,0.01762985046401319,0.01762985046401321,-0.0518627991683984,-0.1637213005066227,0.03479918286849336,0.03479918286849336,-0.01218561348534775,0.0901912142741904,-0.0342519035135548,-0.03425190351355484,0.02462573525390973,0.04735905388634814,-0.0342519035135548,-0.01218561348534774,0.01762985046401319,-0.0342519035135548,0.05200636755713203,0.0176298504640132,-0.0518627991683984,0.04735905388634844,-0.0121856134853478,-0.03425190351355487,0.01762985046401321,-0.03425190351355484,0.0176298504640132,0.05200636755713203,-0.0518627991683984,-0.02386998456406039,0.02462573525390973,0.02462573525390973,-0.0518627991683984,0.02462573525390973,-0.0518627991683984,-0.0518627991683984,0.1861940241727631],
        1.1:[0.847934862928517,-0.165959143785493,-0.165959143785493,0.0488883322932695,-0.1659591437854928,0.04888833229326941,0.04888833229326973,-0.02552352419521355,-0.165959143785493,0.0843695209408966,0.03553018475019108,-0.03270485544606073,0.03553018475019107,-0.03270485544606072,-0.01267020205539345,0.02458021401211373,-0.165959143785493,0.03553018475019108,0.0843695209408965,-0.03270485544606073,0.03553018475019107,-0.0126702020553934,-0.03270485544606078,0.02458021401211373,0.0488883322932695,-0.03270485544606073,-0.03270485544606073,0.04710140997330515,-0.01267020205539341,0.01734269605942574,0.01734269605942577,-0.04968792200673533,-0.1659591437854928,0.03553018475019107,0.03553018475019107,-0.01267020205539341,0.0843695209408965,-0.03270485544606073,-0.03270485544606077,0.02458021401211373,0.04888833229326941,-0.03270485544606072,-0.0126702020553934,0.01734269605942574,-0.03270485544606073,0.04710140997330516,0.01734269605942576,-0.04968792200673533,0.04888833229326973,-0.01267020205539345,-0.03270485544606078,0.01734269605942577,-0.03270485544606077,0.01734269605942576,0.04710140997330519,-0.04968792200673532,-0.02552352419521355,0.02458021401211373,0.02458021401211373,-0.04968792200673533,0.02458021401211373,-0.04968792200673533,-0.04968792200673532,0.1745918655157446],
        1.15: [0.850633240108814,-0.1679327134768955,-0.1679327134768954,0.05029468365677177,-0.1679327134768954,0.05029468365677166,0.05029468365677201,-0.0271307190137005,-0.1679327134768955,0.07920824531377847,0.0361673870616807,-0.03124693849289833,0.03616738706168068,-0.03124693849289832,-0.01310407665728308,0.02445590364372364,-0.1679327134768954,0.0361673870616807,0.07920824531377841,-0.03124693849289833,0.03616738706168068,-0.01310407665728301,-0.03124693849289837,0.02445590364372364,0.05029468365677177,-0.03124693849289833,-0.03124693849289833,0.04276990276986681,-0.01310407665728302,0.01700796055168841,0.01700796055168845,-0.04752495411823606,-0.1679327134768954,0.03616738706168068,0.03616738706168068,-0.01310407665728302,0.0792082453137784,-0.03124693849289832,-0.03124693849289836,0.02445590364372364,0.05029468365677166,-0.03124693849289832,-0.01310407665728301,0.01700796055168841,-0.03124693849289832,0.04276990276986682,0.01700796055168843,-0.04752495411823606,0.05029468365677201,-0.01310407665728308,-0.03124693849289837,0.01700796055168845,-0.03124693849289836,0.01700796055168843,0.04276990276986686,-0.04752495411823606,-0.0271307190137005,0.02445590364372364,0.02445590364372364,-0.04752495411823606,0.02445590364372364,-0.04752495411823606,-0.04752495411823606,0.1636595997807568],
        1.2: [0.852881933994582,-0.1696750433375629,-0.1696750433375629,0.05158726902161654,-0.1696750433375628,0.05158726902161646,0.05158726902161678,-0.02868747354478274,-0.1696750433375629,0.0746377785695922,0.03672114831134183,-0.02988172058225868,0.03672114831134183,-0.02988172058225867,-0.01348972464615204,0.02426586564563296,-0.1696750433375629,0.03672114831134183,0.07463777856959215,-0.02988172058225869,0.03672114831134182,-0.01348972464615199,-0.02988172058225874,0.02426586564563296,0.05158726902161654,-0.02988172058225868,-0.02988172058225869,0.03894197377761674,-0.01348972464615199,0.01663676822042041,0.01663676822042043,-0.04539319436687962,-0.1696750433375628,0.03672114831134183,0.03672114831134182,-0.01348972464615199,0.07463777856959213,-0.02988172058225867,-0.02988172058225873,0.02426586564563296,0.05158726902161646,-0.02988172058225867,-0.01348972464615199,0.01663676822042041,-0.02988172058225867,0.03894197377761674,0.01663676822042043,-0.04539319436687961,0.05158726902161678,-0.01348972464615204,-0.02988172058225874,0.01663676822042043,-0.02988172058225873,0.01663676822042043,0.03894197377761677,-0.04539319436687961,-0.02868747354478274,0.02426586564563296,0.02426586564563296,-0.04539319436687962,0.02426586564563296,-0.04539319436687961,-0.04539319436687961,0.1533786199754193],
        1.25: [0.85475570376276,-0.1712150066595842,-0.1712150066595842,0.05277492007031386,-0.1712150066595841,0.05277492007031378,0.05277492007031412,-0.03019077247234544,-0.1712150066595842,0.07059401836091346,0.0372009850103214,-0.02860990759402296,0.03720098501032138,-0.02860990759402295,-0.01382999877310119,0.02402180342998486,-0.1712150066595842,0.0372009850103214,0.07059401836091343,-0.02860990759402296,0.03720098501032137,-0.01382999877310113,-0.02860990759402302,0.02402180342998486,0.05277492007031386,-0.02860990759402296,-0.02860990759402296,0.03555564270029893,-0.01382999877310114,0.01623871298868003,0.01623871298868007,-0.04330742877295796,-0.1712150066595841,0.03720098501032138,0.03720098501032137,-0.01382999877310114,0.07059401836091341,-0.02860990759402295,-0.028609907594023,0.02402180342998486,0.05277492007031378,-0.02860990759402295,-0.01382999877310113,0.01623871298868003,-0.02860990759402295,0.03555564270029894,0.01623871298868005,-0.04330742877295796,0.05277492007031412,-0.01382999877310119,-0.02860990759402302,0.01623871298868007,-0.028609907594023,0.01623871298868005,0.03555564270029896,-0.04330742877295796,-0.03019077247234544,0.02402180342998486,0.02402180342998486,-0.04330742877295796,0.02402180342998486,-0.04330742877295796,-0.04330742877295796,0.1437249725975694],
        1.3: [0.85631655285644,-0.1725777810237121,-0.172577781023712,0.05386602778534467,-0.1725777810237119,0.0538660277853446,0.05386602778534493,-0.03163852257806559,-0.1725777810237121,0.06701854290788205,0.03761555413173672,-0.0274301186527887,0.03761555413173671,-0.0274301186527887,-0.01412797426079809,0.02373410152052028,-0.172577781023712,0.03761555413173672,0.06701854290788201,-0.0274301186527887,0.03761555413173671,-0.01412797426079803,-0.02743011865278876,0.02373410152052028,0.05386602778534467,-0.0274301186527887,-0.0274301186527887,0.03255626403986046,-0.01412797426079804,0.0158219842084682,0.01582198420846822,-0.04127875070417439,-0.1725777810237119,0.03761555413173671,0.03761555413173671,-0.01412797426079804,0.067018542907882,-0.02743011865278869,-0.02743011865278874,0.02373410152052028,0.0538660277853446,-0.0274301186527887,-0.01412797426079803,0.0158219842084682,-0.02743011865278869,0.03255626403986046,0.01582198420846821,-0.04127875070417437,0.05386602778534493,-0.01412797426079809,-0.02743011865278876,0.01582198420846822,-0.02743011865278874,0.01582198420846821,0.03255626403986049,-0.04127875070417437,-0.03163852257806559,0.02373410152052028,0.02373410152052028,-0.04127875070417439,0.02373410152052028,-0.04127875070417437,-0.04127875070417437,0.134671317141969],
        1.35: [0.857615918934527,-0.1737852921477486,-0.1737852921477485,0.05486847966611346,-0.1737852921477485,0.05486847966611337,0.0548684796661137,-0.03302941264863043,-0.1737852921477486,0.06385852735596687,0.03797267034170559,-0.02633949588186214,0.03797267034170557,-0.02633949588186212,-0.01438683565975319,0.0234118961912273,-0.1737852921477485,0.03797267034170559,0.06385852735596687,-0.02633949588186214,0.03797267034170557,-0.01438683565975312,-0.02633949588186219,0.0234118961912273,0.05486847966611346,-0.02633949588186214,-0.02633949588186214,0.0298958755690136,-0.01438683565975313,0.01539350448057042,0.01539350448057045,-0.03931525137906868,-0.1737852921477485,0.03797267034170557,0.03797267034170557,-0.01438683565975313,0.06385852735596682,-0.02633949588186213,-0.02633949588186217,0.0234118961912273,0.05486847966611337,-0.02633949588186212,-0.01438683565975312,0.01539350448057042,-0.02633949588186213,0.0298958755690136,0.01539350448057044,-0.03931525137906867,0.0548684796661137,-0.01438683565975319,-0.02633949588186219,0.01539350448057045,-0.02633949588186217,0.01539350448057044,0.02989587556901363,-0.03931525137906868,-0.03302941264863043,0.0234118961912273,0.0234118961912273,-0.03931525137906868,0.0234118961912273,-0.03931525137906867,-0.03931525137906868,0.126188381802182],
        1.4: [0.858696511470638,-0.1748566229708764,-0.1748566229708764,0.05578963101458929,-0.1748566229708763,0.05578963101458923,0.05578963101458955,-0.03436279023145117,-0.1748566229708764,0.06106649781683686,0.03827934505368806,-0.02533417792855457,0.03827934505368805,-0.02533417792855457,-0.01460978880415426,0.02306316412749291,-0.1748566229708764,0.03827934505368806,0.06106649781683683,-0.02533417792855458,0.03827934505368803,-0.0146097888041542,-0.02533417792855463,0.02306316412749291,0.05578963101458929,-0.02533417792855457,-0.02533417792855458,0.02753251815759568,-0.0146097888041542,0.01495906932244726,0.01495906932244729,-0.03742259543156614,-0.1748566229708763,0.03827934505368805,0.03827934505368803,-0.0146097888041542,0.0610664978168368,-0.02533417792855457,-0.02533417792855462,0.0230631641274929,0.05578963101458923,-0.02533417792855457,-0.0146097888041542,0.01495906932244726,-0.02533417792855457,0.02753251815759568,0.01495906932244728,-0.03742259543156612,0.05578963101458955,-0.01460978880415426,-0.02533417792855463,0.01495906932244729,-0.02533417792855462,0.01495906932244728,0.02753251815759572,-0.03742259543156613,-0.03436279023145117,0.02306316412749291,0.02306316412749291,-0.03742259543156614,0.0230631641274929,-0.03742259543156612,-0.03742259543156613,0.1182460297805507],
        2: [0.8608529993680772, -0.18096858468091143, -0.18096858468091137, 0.0623383875286934, -0.1809685846809113, 0.06233838752869333,0.06233838752869366, -0.04603823243166169, -0.18096858468091143, 0.044541528182654, 0.03961654054780564, -0.018152238907066732,0.03961654054780563, -0.018152238907066718, -0.015451566672529638, 0.018492451879491764, -0.18096858468091137, 0.03961654054780564,0.04454152818265398, -0.01815223890706673, 0.03961654054780562, -0.015451566672529567, -0.01815223890706678, 0.018492451879491764, 0.0623383875286934, -0.018152238907066732, -0.01815223890706673, 0.012688602671574987, -0.015451566672529568, 0.010335683831523933, 0.010335683831523952, -0.020470764960350062, -0.1809685846809113, 0.03961654054780563, 0.03961654054780562, -0.015451566672529568, 0.04454152818265395, -0.01815223890706671, -0.018152238907066773, 0.018492451879491757, 0.06233838752869333, -0.018152238907066718, -0.015451566672529567, 0.010335683831523933, -0.01815223890706671, 0.01268860267157498, 0.01033568383152395, -0.020470764960350062, 0.06233838752869366, -0.015451566672529638, -0.01815223890706678, 0.010335683831523952, -0.018152238907066773, 0.01033568383152395, 0.012688602671575022, -0.020470764960350073, -0.04603823243166169, 0.018492451879491764, 0.018492451879491764, -0.020470764960350062, 0.018492451879491757, -0.020470764960350062, -0.020470764960350073, 0.0918343259999990], 
        10: [0.862211395470756, -0.18439091438173072, -0.18439091438173066, 0.06707061709729402, -0.18439091438173058, 0.06707061709729395, 0.06707061709729427, -0.057509931146421944, -0.18439091438173072, 0.039433552145943886, 0.03943355213653088, -0.014343696929476742, 0.03943355213653087, -0.014343696929476728, -0.014343696923533504, 0.012299254100701634, -0.18439091438173066, 0.03943355213653088, 0.039433552145943865, -0.014343696929476736, 0.03943355213653086, -0.014343696923533433, -0.014343696929476792, 0.01229925410070163, 0.06707061709729402, -0.014343696929476742, -0.014343696929476736, 0.005217538773638002, -0.01434369692353344, 0.005217538769885284, 0.005217538769885308, -0.004474155152034082, -0.18439091438173058, 0.03943355213653087, 0.03943355213653086, -0.01434369692353344, 0.03943355214594382, -0.014343696929476716, -0.014343696929476787, 0.012299254100701625, 0.06707061709729395, -0.014343696929476728, -0.014343696923533433, 0.005217538769885284, -0.014343696929476716, 0.005217538773637991, 0.005217538769885304, -0.004474155152034078, 0.06707061709729427, -0.014343696923533504, -0.014343696929476792, 0.005217538769885308, -0.014343696929476787, 0.005217538769885304, 0.005217538773638041, -0.004474155152034099, -0.057509931146421944, 0.012299254100701634, 0.01229925410070163, -0.004474155152034082, 0.012299254100701625, -0.004474155152034078, -0.004474155152034099, 0.0038374085463885304], 
        20: [0.8622113136168406, -0.18439096488069012, -0.18439096488069007, 0.06707073152911727, -0.18439096488068998, 0.0670707315291172, 0.06707073152911752, -0.057510272259347836, -0.18439096488069012, 0.03943352098583385, 0.03943352098583384, -0.014343626332399589, 0.039433520985833824, -0.014343626332399575, -0.014343626332399644, 0.012299043663071656, -0.18439096488069007, 0.03943352098583384, 0.03943352098583383, -0.014343626332399585, 0.03943352098583381, -0.014343626332399571, -0.014343626332399639, 0.012299043663071652, 0.06707073152911727, -0.014343626332399589, -0.014343626332399585, 0.005217378799287274, -0.014343626332399578, 0.005217378799287269, 0.005217378799287294, -0.004473678286136602, -0.18439096488068998, 0.039433520985833824, 0.03943352098583381, -0.014343626332399578, 0.039433520985833796, -0.014343626332399564, -0.014343626332399634, 0.012299043663071647, 0.0670707315291172, -0.014343626332399575, -0.014343626332399571, 0.005217378799287269, -0.014343626332399564, 0.005217378799287264, 0.005217378799287289, -0.004473678286136598, 0.06707073152911752, -0.014343626332399644, -0.014343626332399639, 0.005217378799287294, -0.014343626332399634, 0.005217378799287289, 0.005217378799287314, -0.00447367828613662, -0.057510272259347836, 0.012299043663071656, 0.012299043663071652, -0.004473678286136602, 0.012299043663071647, -0.004473678286136598, -0.00447367828613662, 0.003835987032108929]
        }

# Now choose psi2 to be the tfd state of choice from the above:
psi2 = tfds[0.05]

init_gate_1_6 = Initialize(psi2)
init_gate_1_6.label = 'init_gate 1-6'
#sum([a**2 for a in psi2])      # If this is really close to 1, its good enough (just keep alot of digets after decimal point from Mathematica, using NumberForm[exp, n])

# Add the initializing gate to the first qubit (the one to be teleported).
circuit.append(init_gate, [qreg_q[0]])

circuit.append(init_gate_1_6, [qreg_q[1], qreg_q[2], qreg_q[3], qreg_q[4], qreg_q[5], qreg_q[6]])

circuit.barrier()

#circuit.draw()

# In the former circuit, we paired the qubits in Bell-states. Here we use the TFD of the Ising system (upper cell).
"""
# Generate the relevant Bell-pairs (1,4), (2,3), (5,6).

circuit.append(bell_gate, [1, 4])
circuit.append(bell_gate, [2, 3])
circuit.append(bell_gate, [5, 6])

circuit.barrier()

circuit.draw()    # Draw the updated circuit.
"""

# Apply the scrambling unitary to qubits 0-2 and 3-5 (because U is the same as U^* in this case).

# Here I switched 5 with 3, since that is the transformation that is suppose to satisfy the correct Bell-pairs (check it..).
circuit.append(scramble_gate2_1, [0, 1, 2])
circuit.append(scramble_gate2_1_c, [5, 4, 3])

# Not doing anything is equivalent to applying the identity operator on both triplets.

circuit.barrier()

#circuit.draw()    # Draw the updated circuit.

# This stays, since it gives us a measurement in the bell basis.
# Here too, switched qubit 5 with 3.

circuit.append(inv_Bell_gate, [qreg_q[0], qreg_q[3]])
circuit.append(inv_Bell_gate, [qreg_q[1], qreg_q[4]])
circuit.append(inv_Bell_gate, [qreg_q[2], qreg_q[5]])

circuit.barrier()

#circuit.draw()

# Add the measurement of qubit 6, to classical bit 6:
circuit.measure([qreg_q[2], qreg_q[3], qreg_q[1], qreg_q[4]], [creg_c[2], creg_c[3], creg_c[1], creg_c[4]])
#circuit.measure([qreg_q[2], qreg_q[3]], [creg_c[2], creg_c[3]])

#circuit.draw()

# Append to the circuit the inverse of 'init_gate' on qubit 6 (the 'target'):
circuit.append(inverse_init_gate, [qreg_q[6]])

circuit.barrier()

#circuit.draw()

circuit.measure(qreg_q[6], creg_c[6])
circuit.draw()

# See this nice page for more information regarding the simulators and the options of representing the final result of the computation:
# https://qiskit.org/documentation/tutorials/simulators/1_aer_provider.html

# Commented out IPython magic to ensure Python compatibility.
from qiskit import IBMQ, Aer, transpile, assemble, BasicAer
from qiskit import execute
from qiskit.visualization import plot_histogram, plot_bloch_multivector, array_to_latex
# %matplotlib inline

backend = BasicAer.get_backend('qasm_simulator')
job = execute(circuit, backend, shots=20000)
counts = job.result().get_counts()
print('bad counts: ', counts['0000000'])
print('probability for 0000000: ', counts['0000000']/20000)

plot_histogram(job.result().get_counts(), color='midnightblue', title="counts")

"""
# Transpile for simulator
simulator = Aer.get_backend('aer_simulator')
circ = transpile(circuit, simulator)

# Run and get counts
result = simulator.run(circ).result()
counts = result.get_counts(circ)
plot_histogram(counts, title='Bell-State counts')
"""

from qiskit.quantum_info import state_fidelity
# Still having problems measuring the state fidelity of qubit 6 and psi, since qreg_q[6] is not a 'state', 
# and we have yet to find a way to extract it's state (is it always possible? I think not). 
"""
# Check the fidelity of two states (|<psi_1|psi_2>|^2):
fid = state_fidelity(psi, psi, validate=True)
print(fid)
"""

import csv

header = ['name', 'area', 'country_code2', 'country_code3']
data = ['Afghanistan', 652090, 'AF', 'AFG']


with open('countries.csv', 'w', encoding='UTF8', newline='') as f:
    writer = csv.writer(f)

    # write the header
    writer.writerow(header)

    # write the data
    writer.writerow(data)



